<!DOCTYPE html>
<html lang="en" data-lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Games Lab – Edwin Estrada</title>
<meta name="description" content="Interactive cognitive & memory games lab by Edwin Estrada." />
<link rel="preload" as="script" href="Games/game-memory-sequence.js" />
<link rel="preload" as="script" href="Games/game-memory-mapping.js" />
<link rel="preload" as="script" href="Games/game-alz-jaime.js" />
<style>
  :root{--bg:radial-gradient(circle at 20% 20%,#1e1f35,#0b0c13 60%);--panel:#141726;--text:#f2f6ff;--muted:#94a3b8;--accent:#6d6bff;--a2:#ff5fd2;--a3:#42e9ff;--a4:#ffcf4d;--radius:22px;--curve:cubic-bezier(.65,.05,.28,.99)}
  *{box-sizing:border-box;margin:0;padding:0;font-family:system-ui,-apple-system,Inter,Segoe UI,Roboto,sans-serif}
  body{background:var(--bg);min-height:100vh;color:var(--text);-webkit-font-smoothing:antialiased}
  a{text-decoration:none;color:var(--a3)}
  header{display:flex;justify-content:space-between;align-items:center;padding:18px 30px 12px}
  nav a{margin-left:16px;font-size:.75rem;letter-spacing:.5px;opacity:.85;transition:.35s}
  nav a:hover{opacity:1}
  .lang-switch{display:flex;align-items:center;gap:6px;margin-left:18px}
  .lang-btn{background:rgba(255,255,255,.08);border:1px solid rgba(255,255,255,.25);width:34px;height:24px;padding:0;border-radius:6px;cursor:pointer;display:grid;place-items:center;font-size:.6rem;font-weight:600;color:#cbd5e1;transition:.35s}
  .lang-btn[aria-pressed="true"]{background:linear-gradient(90deg,#22d3ee,#2563eb);color:#041019}
  h1{font-size:clamp(1.9rem,3vw,3rem);letter-spacing:.5px;line-height:1.05;background:linear-gradient(90deg,var(--a2),var(--a3),var(--a4));-webkit-background-clip:text;background-clip:text;color:transparent;margin:0}
  .wrap{max-width:1400px;margin:0 auto;padding:6px 32px 70px}
  .intro{display:flex;flex-direction:column;gap:12px;max-width:880px;margin:12px 0 34px}
  .game-select{display:grid;gap:18px;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));margin:20px 0 34px}
  .game-card{position:relative;background:linear-gradient(145deg,#181b2b,#0e1019);border:1px solid rgba(255,255,255,.08);border-radius:26px;padding:18px 18px 20px;display:flex;flex-direction:column;gap:10px;cursor:pointer;transition:.55s var(--curve);overflow:hidden}
  .game-card:hover{transform:translateY(-6px);box-shadow:0 12px 40px -12px rgba(0,0,0,.7),0 0 0 1px rgba(255,255,255,.08)}
  .game-card h2{font-size:.95rem;font-weight:600;letter-spacing:.5px}
  .game-card p{font-size:.65rem;line-height:1.3;opacity:.8}
  .badge-row{display:flex;flex-wrap:wrap;gap:6px}
  .badge{font-size:.55rem;padding:4px 7px;border-radius:999px;background:linear-gradient(90deg,rgba(255,95,210,.3),rgba(99,118,255,.3));border:1px solid rgba(255,255,255,.15);letter-spacing:.5px}
  .game-card.is-active{outline:2px solid var(--a3);}
  .board-area{background:linear-gradient(160deg,#141726,#0b0d14 60%);border:1px solid rgba(255,255,255,.1);border-radius:32px;padding:30px 30px 46px;display:grid;grid-template-columns:330px 1fr;gap:30px;position:relative;overflow:hidden;box-shadow:0 30px 80px -25px rgba(0,0,0,.85),0 0 0 1px rgba(255,255,255,.05)}
  @media (max-width:1000px){.board-area{grid-template-columns:1fr;padding:24px 24px 38px}}
  .panel-col{display:flex;flex-direction:column;gap:18px}
  .status-bar{display:flex;flex-wrap:wrap;gap:8px;font-size:.6rem;letter-spacing:.5px}
  .status-chip{background:linear-gradient(90deg,rgba(66,233,255,.25),rgba(255,95,210,.25));padding:6px 10px;border-radius:14px;border:1px solid rgba(255,255,255,.2);display:inline-flex;gap:6px;align-items:center}
  .controls{display:flex;flex-wrap:wrap;gap:8px}
  .controls button{background:linear-gradient(90deg,#2b3148,#1c2234);border:1px solid rgba(255,255,255,.18);padding:8px 12px;border-radius:12px;color:#fff;font-size:.6rem;letter-spacing:.6px;cursor:pointer;transition:.4s}
  .controls button.start{background:linear-gradient(90deg,#42e9ff,#ff5fd2);color:#08121c;font-weight:600}
  .controls button:hover{filter:brightness(1.18)}
  .message{font-size:.6rem;letter-spacing:.5px;min-height:18px;color:#42e9ff;text-shadow:0 0 14px rgba(66,233,255,.4)}
  .board{display:grid;gap:12px;justify-items:center;align-items:center;margin-top:4px}
  .board.memory-sequence{grid-template-columns:repeat(2,120px)}
  .board.memory-mapping{grid-template-columns:repeat(3,100px)}
  .board.alz-jaime{grid-template-columns:repeat(4,70px)}
  .tile{width:100%;aspect-ratio:1/1;border-radius:20px;background:linear-gradient(145deg,#262c42,#161b2b);border:1px solid rgba(255,255,255,.12);cursor:pointer;position:relative;overflow:hidden;transition:.4s;box-shadow:0 4px 12px -4px rgba(0,0,0,.85),0 0 0 1px rgba(255,255,255,.04)}
  .tile.active{transform:scale(1.08);box-shadow:0 0 0 1px rgba(255,255,255,.25),0 0 25px -4px rgba(255,255,255,.65)}
  .tile.correct{animation:cg .6s}
  .tile.wrong{animation:wg .6s}
  @keyframes cg{0%{transform:scale(1)}30%{transform:scale(1.16)}70%{transform:scale(.94)}100%{transform:scale(1)}}
  @keyframes wg{0%{transform:translateX(0)}20%{transform:translateX(-8px)}45%{transform:translateX(8px)}70%{transform:translateX(-4px)}100%{transform:translateX(0)}}
  footer{padding:50px 30px 60px;text-align:center;font-size:.6rem;color:rgba(255,255,255,.55)}
  footer a{color:var(--a3)}
  .footer-license{margin-top:14px;opacity:.7}
</style>
</head>
<body>
<header>
  <div style="font-weight:600;letter-spacing:.6px;font-size:.9rem">Games Lab · Edwin Estrada</div>
  <nav>
    <a href="index.html">Home</a>
    <a href="cv.html">CV</a>
    <a href="mailto:edwin.estro@me.com">Contact</a>
    <div class="lang-switch" aria-label="Language selector">
      <button class="lang-btn" id="gLangEn" aria-pressed="true" aria-label="English">US</button>
      <button class="lang-btn" id="gLangEs" aria-pressed="false" aria-label="Español México">MX</button>
    </div>
  </nav>
</header>
<div class="wrap">
  <div class="intro">
    <h1 id="pageTitle">Interactive Cognitive & Memory Games</h1>
    <p id="pageSub" style="font-size:.8rem;line-height:1.5;opacity:.85">Experiments in sequencing, spatial recall and gentle cognitive reinforcement. Each game is modular vanilla JS with adaptive difficulty.</p>
  </div>
  <div class="game-select" id="gameSelect" role="tablist" aria-label="Game selector">
    <div class="game-card is-active" role="tab" tabindex="0" aria-selected="true" data-game="memory-sequence">
      <h2>Memory Sequence</h2>
      <p id="desc-memory-sequence">Follow and replicate an expanding color pattern. Focus & reaction.</p>
      <div class="badge-row"><span class="badge">Sequence</span><span class="badge">Adaptive</span></div>
    </div>
    <div class="game-card" role="tab" tabindex="0" aria-selected="false" data-game="memory-mapping">
      <h2>Memory Mapping</h2>
      <p id="desc-memory-mapping">Pattern flashes then disappears. Rebuild by position.</p>
      <div class="badge-row"><span class="badge">Spatial</span><span class="badge">Delay</span></div>
    </div>
    <div class="game-card" role="tab" tabindex="0" aria-selected="false" data-game="alz-jaime">
      <h2>Alz‑Jaime</h2>
      <p id="desc-alz-jaime">Gentle progressive sequence with optional persistent hints.</p>
      <div class="badge-row"><span class="badge">Gentle</span><span class="badge">Assist</span></div>
    </div>
    <div class="game-card" role="tab" tabindex="0" aria-selected="false" data-game="focus-pulse">
      <h2>Focus Pulse</h2>
      <p>Track shrinking pulse targets. Improves timing & sustained attention.</p>
      <div class="badge-row"><span class="badge">Timing</span><span class="badge">Attention</span></div>
    </div>
    <div class="game-card" role="tab" tabindex="0" aria-selected="false" data-game="ant-path">
      <h2>Ant Path</h2>
      <p>Navigate the ant to food. Spatial planning & quick decisions.</p>
      <div class="badge-row"><span class="badge">Maze</span><span class="badge">Movement</span></div>
    </div>
  </div>
  <div class="board-area" aria-live="polite">
    <div class="panel-col">
      <h2 id="activeGameTitle" style="font-size:1.1rem;letter-spacing:.6px">Memory Sequence</h2>
      <p id="activeGameDesc" style="font-size:.7rem;line-height:1.4;opacity:.8">Follow and replicate an expanding color pattern. Focus & reaction.</p>
      <div class="status-bar" id="statusBar"></div>
      <div class="controls" id="controls"></div>
      <div class="message" id="message"></div>
    </div>
    <div class="panel-col" id="boardMount"></div>
  </div>
</div>
<footer>
  © 2025 Edwin Estrada · <a href="index.html">Landing</a> · <a href="cv.html">CV</a>
  <div class="footer-license" id="gLicense">MIT Licensed · Created with GitHub Copilot assistance.</div>
</footer>
<script type="module">
  import { createMemorySequenceGame } from './Games/game-memory-sequence.js';
  import { createMemoryMappingGame } from './Games/game-memory-mapping.js';
  import { createAlzJaimeGame } from './Games/game-alz-jaime.js';

  function createFocusPulseGame({ mount, statusBar, controls, message }){
    const state={ running:false, score:0, level:0, lang:document.documentElement.getAttribute('data-lang')||'en' };
    const texts={ en:{start:'START',score:'Score',lvl:'Level',instr:'Click the circle as it shrinks (timing bonus)',miss:'Miss',pts:p=>`${p} pts`}, es:{start:'INICIAR',score:'Puntaje',lvl:'Nivel',instr:'Haz clic mientras se encoge (bono por tiempo)',miss:'Falla',pts:p=>`${p} pts`} };
    const board=document.createElement('div'); board.style.cssText='position:relative;width:320px;height:320px;display:flex;align-items:center;justify-content:center;'; mount.appendChild(board);
    const timeouts=[];
    statusBar.appendChild(chip(`<strong>${texts[state.lang].score}:</strong><span id="fpScore">0</span>`));
    statusBar.appendChild(chip(`<strong>${texts[state.lang].lvl}:</strong><span id="fpLvl">0</span>`));
    const start=btn(texts[state.lang].start,'start',()=>{ if(state.running) return; state.running=true; state.score=0; state.level=0; next(); }); controls.appendChild(start);
    function next(){ if(!state.running) return; state.level++; qs('#fpLvl').textContent=state.level; spawnPulse(); }
    function spawnPulse(){ if(!state.running) return; const pulse=document.createElement('div'); const size=220; pulse.style.cssText=`position:absolute;width:${size}px;height:${size}px;border-radius:50%;background:radial-gradient(circle,#42e9ff,#2563eb);opacity:.9;cursor:pointer;transform:scale(1);transition:transform 1.6s linear;`; board.appendChild(pulse); const startTime=performance.now(); requestAnimationFrame(()=> pulse.style.transform='scale(.05)'); let clicked=false; const timeout=setTimeout(()=> { if(!clicked){ pulse.remove(); message.textContent=texts[state.lang].miss; next(); } },1600); timeouts.push(timeout); pulse.addEventListener('click',()=>{ if(clicked||!state.running) return; clicked=true; clearTimeout(timeout); const elapsed=performance.now()-startTime; const progress= Math.min(1, elapsed/1600); // 0 at start, 1 at end
      // size factor: scale goes 1 -> 0.05 linearly
      const currentScale=1 - 0.95*progress; // approximate
      let points=0; if(currentScale<=0.25) points=2; else if(currentScale<=0.5) points=1; else points=0; if(points>0){ state.score+=points; qs('#fpScore').textContent=state.score; }
      message.textContent= points>0? texts[state.lang].pts(points): texts[state.lang].miss; pulse.style.transition='transform .25s, opacity .25s'; pulse.style.transform='scale(0)'; pulse.style.opacity='0'; const t2=setTimeout(()=>{ pulse.remove(); next(); },260); timeouts.push(t2); }); }
    function qs(sel){ return mount.ownerDocument.querySelector(sel); }
    function chip(html){ const d=document.createElement('div'); d.className='status-chip'; d.innerHTML=html; return d; }
    function btn(label,cls,fn){ const b=document.createElement('button'); b.textContent=label; b.className=cls; b.addEventListener('click',fn); return b; }
    message.textContent=texts[state.lang].instr;
    return { destroy(){ state.running=false; timeouts.forEach(clearTimeout); mount.innerHTML=''; } };
  }

  function createAntPathGame({ mount, statusBar, controls, message }){
    const gridSize=5; const state={ x:0, y:0, food:randFood(), score:0, lang:document.documentElement.getAttribute('data-lang')||'en' };
    const texts={ en:{score:'Score',start:'START',instr:'Move the ant (WASD / Arrows) to reach food'}, es:{score:'Puntaje',start:'INICIAR',instr:'Mueve la hormiga (WASD / Flechas) para llegar a la comida'} };
    const board=document.createElement('div'); board.style.cssText='display:grid;grid-template-columns:repeat(5,60px);gap:10px;'; mount.appendChild(board);
    for(let i=0;i<gridSize*gridSize;i++){ const cell=document.createElement('div'); cell.style.cssText='width:60px;height:60px;border-radius:14px;background:#192235;position:relative;display:flex;align-items:center;justify-content:center;font-size:.6rem;color:#7aa2d2;'; board.appendChild(cell); }
    statusBar.appendChild(chip(`<strong>${texts[state.lang].score}:</strong><span id="antScore">0</span>`));
    const start=btn(texts[state.lang].start,'start',()=>{ draw(); message.textContent=texts[state.lang].instr; }); controls.appendChild(start);
    function randFood(){ return { x:Math.floor(Math.random()*gridSize), y:Math.floor(Math.random()*gridSize)}; }
    function draw(){ [...board.children].forEach((c,i)=>{ c.textContent=''; c.style.background='#192235'; const x=i%gridSize, y=Math.floor(i/gridSize); if(x===state.x && y===state.y){ c.textContent='🟡'; c.style.background='#27405d'; } if(x===state.food.x && y===state.food.y){ c.textContent='🍎'; } }); }
    function move(dx,dy){ state.x=(state.x+dx+gridSize)%gridSize; state.y=(state.y+dy+gridSize)%gridSize; if(state.x===state.food.x && state.y===state.food.y){ state.score++; document.getElementById('antScore').textContent=state.score; state.food=randFood(); } draw(); }
    const handler=e=>{ const k=e.key.toLowerCase(); if(k==='arrowup'||k==='w') move(0,-1); else if(k==='arrowdown'||k==='s') move(0,1); else if(k==='arrowleft'||k==='a') move(-1,0); else if(k==='arrowright'||k==='d') move(1,0); };
    window.addEventListener('keydown',handler);
    function chip(html){ const d=document.createElement('div'); d.className='status-chip'; d.innerHTML=html; return d; }
    function btn(label,cls,fn){ const b=document.createElement('button'); b.textContent=label; b.className=cls; b.addEventListener('click',fn); return b; }
    message.textContent=texts[state.lang].instr; draw();
    return { destroy(){ window.removeEventListener('keydown',handler); mount.innerHTML=''; } };
  }

  // Page level i18n (added)
  const pageI18n = {
    en:{ title:'Interactive Cognitive & Memory Games', sub:'Experiments in sequencing, spatial recall and gentle cognitive reinforcement. Each game is modular vanilla JS with adaptive difficulty.', meta:'Interactive cognitive & memory games lab by Edwin Estrada.' },
    es:{ title:'Juegos Interactivos de Memoria y Cognición', sub:'Experimentos en secuencias, recordación espacial y refuerzo cognitivo suave. Cada juego es JS modular con dificultad adaptable.', meta:'Laboratorio de juegos interactivos de memoria y cognición de Edwin Estrada.' }
  };

  // Update meta with new games (fixed self-referential initialization bug)
  const meta = {
    'memory-sequence': { en:{title:'Memory Sequence',desc:'Follow and repeat a growing color sequence. Improves focus and reaction.'}, es:{title:'Secuencia de Memoria',desc:'Sigue y repite una secuencia creciente de colores. Mejora enfoque y reacción.'}, factory:createMemorySequenceGame },
    'memory-mapping': { en:{title:'Memory Mapping',desc:'Colors glow one by one across the board. Recall their order by clicking tiles.'}, es:{title:'Mapeo de Memoria',desc:'Los colores brillan uno a uno. Reproduce el orden.'}, factory:createMemoryMappingGame },
    'alz-jaime': { en:{title:'Alz‑Jaime',desc:'Gentle progressive pattern with optional hints. Designed for calm cognitive reinforcement.'}, es:{title:'Alz‑Jaime',desc:'Patrón progresivo suave con pistas opcionales. Refuerzo cognitivo tranquilo.'}, factory:createAlzJaimeGame },
    'focus-pulse': { en:{title:'Focus Pulse',desc:'Click shrinking pulse targets at the right moment.'}, es:{title:'Pulso Foco',desc:'Haz clic en los pulsos decrecientes en el momento indicado.'}, factory:createFocusPulseGame },
    'ant-path': { en:{title:'Ant Path',desc:'Guide the ant to food using keys. Plan & react.'}, es:{title:'Ruta Hormiga',desc:'Guía la hormiga a la comida con teclas. Planifica y reacciona.'}, factory:createAntPathGame }
  };

  const state={ active:'memory-sequence', api:null, lang:'en' };
  const gameSelect=document.getElementById('gameSelect');
  const activeTitle=document.getElementById('activeGameTitle');
  const activeDesc=document.getElementById('activeGameDesc');
  const boardMount=document.getElementById('boardMount');
  const statusBar=document.getElementById('statusBar');
  const controls=document.getElementById('controls');
  const message=document.getElementById('message');
  const langBtns={ en:document.getElementById('gLangEn'), es:document.getElementById('gLangEs') };
  const license=document.getElementById('gLicense');
  const pageTitleEl=document.getElementById('pageTitle');
  const pageSubEl=document.getElementById('pageSub');
  const metaDescEl=document.querySelector('meta[name="description"]');

  const licenseText={ en:'MIT Licensed · Created with GitHub Copilot assistance.', es:'Licencia MIT · Creado con asistencia de GitHub Copilot.' };

  function mountGame(key){
    if(state.api && state.api.destroy) state.api.destroy();
    boardMount.innerHTML=''; statusBar.innerHTML=''; controls.innerHTML=''; message.textContent='';
    state.active=key; const info=meta[key]; const tr=info[state.lang];
    activeTitle.textContent=tr.title; activeDesc.textContent=tr.desc;
    state.api = info.factory({ mount:boardMount, statusBar, controls, message });
  }

  function setLang(code){
    if(!pageI18n[code]) return; state.lang=code; document.documentElement.setAttribute('data-lang',code);
    // Update game cards & active panel
    Object.entries(meta).forEach(([k,v])=>{
      const card=document.querySelector(`.game-card[data-game="${k}"]`);
      if(card){ card.querySelector('h2').textContent=v[code].title; card.querySelector('p').textContent=v[code].desc; }
      if(k===state.active){ activeTitle.textContent=v[code].title; activeDesc.textContent=v[code].desc; }
    });
    // Update page level strings
    pageTitleEl.textContent = pageI18n[code].title;
    pageSubEl.textContent = pageI18n[code].sub;
    if(metaDescEl) metaDescEl.setAttribute('content', pageI18n[code].meta);
    license.textContent=licenseText[code];
    Object.entries(langBtns).forEach(([k,b])=> b.setAttribute('aria-pressed',k===code?'true':'false'));
  }

  function activate(card){ document.querySelectorAll('.game-card').forEach(c=>{ const a=c===card; c.classList.toggle('is-active',a); c.setAttribute('aria-selected',a); }); mountGame(card.dataset.game); }

  gameSelect.addEventListener('click',e=>{ const card=e.target.closest('.game-card'); if(!card) return; activate(card); });
  gameSelect.addEventListener('keydown',e=>{ if(e.key==='Enter' || e.key===' '){ const card=e.target.closest('.game-card'); if(card){ e.preventDefault(); activate(card);} } });
  langBtns.en.addEventListener('click',()=> setLang('en'));
  langBtns.es.addEventListener('click',()=> setLang('es'));

  // init
  mountGame(state.active);
  setLang('en');
</script>
</body>
</html>
